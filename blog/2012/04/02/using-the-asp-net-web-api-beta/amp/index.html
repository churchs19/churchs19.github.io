<!doctype html>
<html ⚡>
  <head>
    <meta charset="utf-8">
    <link rel="canonical" href="../index.html" >
    
    <title>Using the ASP.NET Web API Beta | Shane Church</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    
    
    
    
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "BlogPosting",
            
            "headline": "Using the ASP.NET Web API Beta | Shane Church",
            
			
			"mainEntityOfPage":{
			    "@type":"WebPage",
			    "@id":"http://localhost:4000/blog/2012/04/02/using-the-asp-net-web-api-beta/"
			},
			"datePublished": "2012-04-02T20:21:00.000Z",
			"dateModified": "2017-02-20T15:33:43.032Z",
			
			"image": {
				"@type": "ImageObject",
				"url": "\amp-dist\default-post.jpg",
				"width" : 512,
				"height" : 512
			},
			
			"author": {
			    "@type": "Person",
			    "name": "Shane Church"
			},
			"publisher": {
			    "@type": "Organization",
			    "name": "Shane Church"
			    
			    ,
			    "logo": {
			      "@type": "ImageObject",
			      "url": "http://localhost:4000/http://localhost:4000\amp-dist\SCLogo-purple_amp.png",
			      "width": 600,
			      "height": 60
			    }
			    
			}
		}
	</script>
	
	<style amp-custom>
		

@font-face {
    font-family: 'poiret_oneregular';
    src: url('/fonts/Poiret One regular-webfont.eot');
    src: url('/fonts/Poiret One regular-webfont.eot?#iefix') format('embedded-opentype'), url('/fonts/Poiret One regular-webfont.woff2') format('woff2'), url('/fonts/Poiret One regular-webfont.woff') format('woff'), url('/fonts/Poiret One regular-webfont.ttf') format('truetype'), url('/fonts/Poiret One regular-webfont.svg#poiret_oneregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'robotoregular';
    src: url('/fonts/Roboto regular-webfont.eot');
    src: url('/fonts/Roboto regular-webfont.eot?#iefix') format('embedded-opentype'), url('/fonts/Roboto regular-webfont.woff2') format('woff2'), url('/fonts/Roboto regular-webfont.woff') format('woff'), url('/fonts/Roboto regular-webfont.ttf') format('truetype'), url('/fonts/Roboto regular-webfont.svg#robotoregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

/*#header:after,
.nav ul:after {
    content: "."
}
.entry-content ul,
ol,
ul {
    list-style: none
}
.article-nav-link-wrap,
code {
    text-shadow: 0 1px #fff
}
#page-nav a,
.article-nav-link-wrap,
a {
    text-decoration: none
}
#page-nav,
.article-nav-caption,
.nav {
    text-transform: uppercase
}
#footer:after,
#header:after,
.clearfix:after,
.nav ul:after {
    clear: both;
    visibility: hidden
}
a,
abbr,
acronym,
address,
applet,
big,
blockquote,
body,
caption,
cite,
code,
dd,
del,
dfn,
div,
dl,
dt,
em,
fieldset,
form,
h1,
h2,
h3,
h4,
h5,
h6,
html,
iframe,
img,
ins,
kbd,
label,
legend,
li,
object,
ol,
p,
pre,
q,
s,
samp,
small,
span,
strike,
strong,
sub,
sup,
table,
tbody,
td,
tfoot,
th,
thead,
tr,
tt,
ul,
var {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    font-weight: inherit;
    font-style: inherit;
    font-family: inherit;
    font-size: 100%;
    vertical-align: baseline
}
caption,
table,
td,
th {
    vertical-align: middle
}
table {
    border-collapse: separate;
    border-spacing: 0
}
caption,
td,
th {
    text-align: left;
    font-weight: 400
}
a img {
    border: none
}
button,
input {
    margin: 0;
    padding: 0
}
button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0
}
.boxCaption p,
code,
pre {
    -webkit-border-radius: 5px
}*/
html {
    font-family: 'robotoregular', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    font-family: 'robotoregular', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.5;
    font-weight: 300;
    font-size: 14px;
    color: #2a2a2f;
    background-color: #fff;
    -webkit-text-size-adjust: 100%;
    -webkit-overflow-scrolling: touch;
    -webkit-font-smoothing: antialiased;
}

.homeLink {
    background: #49488E;
    -webkit-border-radius: 3px;
    border-radius: 3px
}
.homeLink a {
    display: block;
    padding: 1em;
    text-align: center;
    color: #fff
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: 'poiret_oneregular';
    margin: 0;
    font-weight: 700;
    text-transform: uppercase;
    color: #49488E;
}

h1 {
    font-size: 2.0em;
}

h2 {
    font-size: 1.85em;
}

h3 {
    font-size: 1.5em;
}

h4 {
    font-size: 1.2em;
}

h5 {
    font-size: 1.0em;
}

h6 {
    font-size: 0.86em;
}

a {
    color: #49488E;
}

a {
    outline: none;
    cursor: pointer;
    text-decoration: none;
}

a:focus,
a:hover {
    outline: none;
    color: #49488E;
    text-decoration: none;
}


#container {
    padding: 12px;
}

#main {
    margin-top: 20px;
}

.article-header,
.article-meta {
    text-align: center;
}

.article-meta {
    font-size: 0.8em;
    color: #B1B0DA;
}

#article-nav {
    margin: 20px 0;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
}

.article-nav-link-wrap {
    text-align: center;
    font-size: 0.8em;
    flex: 1 1 50%;
}
.article-nav-link-wrap:first-child:not(:last-child) {
    border-right: 1px solid #B1B0DA;
}

.article-nav-caption {
    color: #B1B0DA;
}

.copyright {
    color: #B1B0DA;
    text-align: center;
    font-size: 0.7em;
}

hr.article-divider {
    width: 30%;
    margin: 20px auto;
}
	</style>
	
  </head>
  <body>
  	
  	<!-- google analytics -->
  	
  	<amp-analytics type="googleanalytics" id="google-analytics">
		<script type="application/json">
		{
		  "vars": {
		    "account": "UA-74778051-1"
		  },
		  "triggers": {
		    "trackPageview": {
		      "on": "visible",
		      "request": "pageview"
		    }
		  }
		}
		</script>
	</amp-analytics>
	
  	
  	<div id="container">
  	
  		<!-- title -->
	  	<header id="header">
	
	  		
	  		<div class="blog-title">
				<a href="/">
					<amp-img src="\amp-dist\SCLogo-purple_amp.png" width="600" height="60" layout="responsive">
					</amp-img>
				</a>
			</div>
			
			
		</header>
	  	
	  	
		<div id="main">	  	
			<article id="post-using-the-asp-net-web-api-beta" class="post">
				<header class="article-header">
					
						<h1 class="article-title entry-title" itemprop="name">
							Using the ASP.NET Web API Beta
						</h1>
					
				</header>

				<div class="article-meta">
					<div class="article-datetime">
						<time datetime="Apr 2 2012" itemprop="datePublished">Apr 2 2012</time>
					</div>
					                            
				</div>

				
				<div class="entry-image">
					<amp-img src="http://localhost:4000\amp-dist\default-post.jpg" width="512" height="512" layout="responsive">
					</amp-img>
				</div>
				
				<!-- entry content -->
				<div class="entry-content ecp">
					<p>Over the last week, I was building some data services for a demo project for our non-profit subsidiary, <a href="http://www.effectivesc.org" target="_blank" rel="external">EffectiveSC</a>, and we decided to use this quick project as an opportunity to get familiar with the <a href="http://www.asp.net/web-api" target="_blank" rel="external">ASP.NET Web API</a> beta that is part of the ASP.NET MVC 4 beta.  My first impressions of the Web API are generally very positive.  I was able to get a basic Create-Read-Update-Delete (CRUD) service up and running using the appropriate HTTP verbs (PUT, GET, POST, DELETE respectively) in just a couple of hours and the service automatically translated my model to JSON or XML based on the Accepts header in the incoming request.</p>
<p>You can add the ASP.NET Web API to an existing project by running the following from the <a href="http://www.nuget.org" target="_blank" rel="external">NuGet Package Manager</a> console:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Install-Package AspNetWebApi</div></pre></td></tr></table></figure>
<p>or create a new project with the ASP.NET MVC 4 Web Application template installed with the <a href="http://www.asp.net/mvc/mvc4" target="_blank" rel="external">ASP.NET MVC 4 beta</a>.</p>
<p>If you create a new project, the Web API template creates a new controller, ValuesController, that inherits from the new <a href="http://msdn.microsoft.com/en-us/library/system.web.http.apicontroller\(v=vs.108\" target="_blank" rel="external">ApiController class</a>.aspx).  This new class looks something like this:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BadgeController</span> : <span class="title">ApiController</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">// GET /api/badge</span></div><div class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;EarnedBadge&gt; <span class="title">Get</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        RelationalDataModel data = <span class="keyword">new</span> RelationalDataModel();</div><div class="line">        <span class="keyword">return</span> data.EarnedBadges;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// GET /api/badge/5</span></div><div class="line">    <span class="function"><span class="keyword">public</span> EarnedBadge <span class="title">Get</span>(<span class="params"><span class="keyword">long</span> id</span>)</span></div><div class="line">    &#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// POST /api/badge</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Post</span>(<span class="params">EarnedBadge <span class="keyword">value</span></span>)</span></div><div class="line">    &#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// PUT /api/badge/5</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">Put</span>(<span class="params">EarnedBadge <span class="keyword">value</span></span>)</span></div><div class="line">    &#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// DELETE /api/badge/5</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params"><span class="keyword">int</span> id</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpResponseException(HttpStatusCode.MethodNotAllowed);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>In my case, I was sending a EarnedBadge object as my model.  In each of the methods, I simply performed the required query operations against my Entity Framework Code First data store and the framework took care of all of the serialization.  The EarnedBadge object was defined as:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EarnedBadge</span></div><div class="line">&#123;</div><div class="line">    [Key]</div><div class="line">    <span class="keyword">public</span> <span class="keyword">long</span> EarnedBadgeId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    [Required]</div><div class="line">    <span class="keyword">public</span> <span class="keyword">long</span> ProviderId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    [Required]</div><div class="line">    <span class="keyword">public</span> <span class="keyword">long</span> BadgeId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    [Required]</div><div class="line">    <span class="keyword">public</span> <span class="keyword">long</span> UserId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    [Required]</div><div class="line">    <span class="keyword">public</span> DateTime EarnedDateTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Note &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>While this is a pretty simple object, the serialization resulted in the following results for JSON and XML respectively:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;        </div><div class="line">    <span class="string">"EarnedBadgeId"</span>:<span class="number">123456789</span>,        </div><div class="line">    <span class="string">"ProviderId"</span>:<span class="number">123456789</span>,        </div><div class="line">    <span class="string">"BadgeId"</span>:<span class="number">123456789</span>,        </div><div class="line">    <span class="string">"UserId"</span>:<span class="number">123456789</span>,        </div><div class="line">    <span class="string">"EarnedDateTime"</span>:<span class="string">"2012-03-28T00:54:06.843"</span>,        </div><div class="line">    <span class="string">"Note"</span>:<span class="string">"string"</span>    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>and</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">EarnedBadge</span>&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">EarnedBadgeId</span>&gt;</span>123456789<span class="tag">&lt;/<span class="name">EarnedBadgeId</span>&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">ProviderId</span>&gt;</span>123456789<span class="tag">&lt;/<span class="name">ProviderId</span>&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">BadgeId</span>&gt;</span>123456789<span class="tag">&lt;/<span class="name">BadgeId</span>&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">UserId</span>&gt;</span>123456789<span class="tag">&lt;/<span class="name">UserId</span>&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">EarnedDateTime</span>&gt;</span>2012-02-18T00:54:06.843<span class="tag">&lt;/<span class="name">EarnedDateTime</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Note</span>&gt;</span>String<span class="tag">&lt;/<span class="name">Note</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">EarnedBadge</span>&gt;</span></div></pre></td></tr></table></figure>
<p>I did use the <a href="http://blogs.msdn.com/b/henrikn/archive/20120218/using-json-net-with-asp-net-web-api.aspx" target="_blank" rel="external">JSON.NET formatter as described by Henrik Nielsen</a> in order to format the dates into ISO-8601 format which is a little easier for JavaScript-based clients to consume. From my perspective, one of the nicest features of using the ASP.NET Web API is the control it gives over the HTTP response messages, especially for exceptions. The new HttpResponseException allows me to control the HTTP status codes that are sent when errors occur such as the HTTP 405 Method Not Allowed for the Delete method in the example above.  This allows me to build the service in a truly RESTful fashion and to send meaningful error messages back to the client.</p>
<p>Another really impressive feature is the built in <a href="http://www.odata.org" target="_blank" rel="external">OData</a> query support.  Any IEnumerable or IQueryable object that is returned by the service is automatically queryable using the OData query string parameter syntax which makes building paging and searching of data sets really easy.</p>
<p>The one feature that I really like in WCF’s REST implementation that isn’t available yet in the ASP.NET Web API is the auto-generated service API documentation.  The ASP.NET Web API team has confirmed that this feature will be available in the final release.  It appears that, for most of the service work that I do at <a href="http://www.effectiveui.com" target="_blank" rel="external">EffectiveUI</a>, the Web API will be the way to go moving forward.  <a href="http://idesign.net/articles/asp_net_web_api_vs_wcf.htm" target="_blank" rel="external">A good discussion of the ASP.NET Web API vs. WCF can be found at iDesign</a> and it largely mirrors my my own thoughts on the comparison.</p>
<p>I hope my initial thoughts and experiences prove useful and I’d love to hear how others are using this new tool.</p>

				</div>
			</article>
		  	
		  <hr class="article-divider"/>
		  	
			<div class="homeLink">
				<a href="/">HOME</a>
			</div>
		  	
			<!-- article nav -->
			
			<nav id="article-nav">
			  
			    <a href="/blog/2012/03/12/one-year-at-effectiveui/amp/index.html" id="article-nav-older" class="article-nav-link-wrap">
			      <strong class="article-nav-caption">Older</strong>
			      <div class="article-nav-title">
			        
			          One Year at EffectiveUI
			        
			      </div>
			    </a>
			  
			  
			    <a href="/blog/2012/04/05/mobile-web-hybrid-or-native-mobile-ndash-how-do-you-choose/amp/index.html" id="article-nav-newer" class="article-nav-link-wrap">
			      <strong class="article-nav-caption">Newer</strong>
			      <div class="article-nav-title">
			        
			          Mobile Web, Hybrid, or Native Mobile – How Do You Choose?
			        
			      </div>
			    </a>
			  
			</nav>
			
			
		</div>
		
		<footer id="footer">
				<div class="copyright">
					&copy; 2017&nbsp;Shane Church
				</div>
		</footer>
	</div>
  	
  </body>
</html>